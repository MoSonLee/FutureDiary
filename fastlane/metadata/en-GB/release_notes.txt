Fix bugs and improve reliability
